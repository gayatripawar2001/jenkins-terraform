pipeline {
tools {
  terraform 'Terraform'
}
agent any
stages{
  stage ('terraform version') { 
  steps {
   sh '''
    terraform --version
   ''' 
    }
    }
    
  stage ('terraform init') { 
  steps {
   sh '''
   terraform init
   ''' 
   }
   }

  stage('Terraform Apply') {
            steps {
                withCredentials([[$class: 'AmazonWebServicesCredentialsBinding', accessKeyVariable: 'AWS_ACCESS_KEY_ID', credentialsId: 'aws_credentials', secretKeyVariable: 'AWS_SECRET_ACCESS_KEY']]) 
                {
                
                sh 'terraform apply --auto-approve'
                }
          }
       }
    }
  }
